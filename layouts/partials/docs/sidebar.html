{{ $currentPage := . }}
{{ $docsV1 := .Site.GetPage "section" "docs/v1" }}
{{ $docsV2 := .Site.GetPage "section" "docs/v2" }}
{{ $version := $docsV2 }}
{{ if or (.IsDescendant (.Site.GetPage "section" "docs/v1")) (eq . (.Site.GetPage "section" "docs/v1")) }}
{{ $version = $docsV1 }}
{{ end }}

<div class="d-flex w-100 align-items-center mb-4">
  {{ partial "docs/search" . }}
  <div class="flex-shrink-0">
    <a class='d-inline-block ml-3 {{ if eq $currentPage.Params.doc_version "docs_v2" }}font-weight-bold{{ end }}'
        href='{{ relref . "/docs/v2/_index.md" }}'>v2</a>
    <a class='d-inline-block ml-2 {{ if eq $currentPage.Params.doc_version "docs_v1" }}font-weight-bold{{ end }}'
        href='{{ relref . "/docs/v1/_index.md" }}'>v1</a>
  </div>
</div>

<div class="docs-sidebar list-group">

  {{ range (index $.Site.Menus $version.Params.doc_version) }}

    <div class="list-group-item">
      {{ .Title }}
    </div>
    <div class="list-group-item btn-group-vertical btn-group-sm">
      {{ with .Page }}
        {{ range .Pages }}
          <a href="{{ .Permalink }}" class='btn btn-link text-left {{ if eq .Permalink $currentPage.Permalink }}font-weight-bold{{ end }}'>{{ .Title }}</a>

          {{ range .Pages }}
            <a href="{{ .Permalink }}" class='btn btn-link text-left'><span class="text-muted">&boxur;</span> {{ .Title }}</a>
          {{ end }}

        {{ else }}
          <a href="{{ .Permalink }}" class='btn btn-link text-left {{ if eq .Permalink $currentPage.Permalink }}font-weight-bold{{ end }}'>{{ .Title }}</a>
        {{ end }}

      {{ end }}
    </div>

  {{ end }}

</div>

<div class="small text-muted my-4">
  Found a typo or want to add something? Edit this page on <a href="{{ .Site.Params.DocsRepo }}">Github</a>.
</div>
